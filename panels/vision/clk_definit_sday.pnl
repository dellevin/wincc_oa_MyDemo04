V 13
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
PANEL,-1 -1 476 409 N "_3DFace" 0
E E E E E 1 -1 -1 0  20 6
""0  1
E E 2
"CBRef" "0"
"EClose" E
0 0 0
""
DISPLAY_LAYER, 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
LAYER, 0 
4
LANG:10001 6 Layer1
LANG:10004 6 Layer1
LANG:10000 6 Layer1
LANG:10027 6 Layer1
6 10
"Border1"
""
1 21 25 E E E 1 E 1 E N "Weiss" E N "_Transparent" E E
 E E
10 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 21 25 466 399
6 11
"Border2"
""
1 20 24 E E E 1 E 1 E N "schwarz" E N "_Transparent" E E
 E E
11 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 20 24 465 398
2 12
"lblHolidays"
""
1 34 16 E E E 1 E 1 E N {0,0,0} E N "_3DFace" E E
 E E
12 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  1 E 32 16 105 31
0 5 2 "0s" 0 0 0 192 0 0  32 16 1
4
LANG:10001 26 arial,-1,13,5,75,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,75,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,75,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,75,0,0,0,0,0
0 4
LANG:10001 8 Holidays
LANG:10004 6 假日
LANG:10000 10 Sondertage
LANG:10027 16 Выходные
2 22
"lblYear"
""
1 310 262 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
22 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 312 262 334 277
0 2 2 "0s" 0 0 0 192 0 0  312 262 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 4 Year
LANG:10004 3 年
LANG:10000 4 Jahr
LANG:10027 6 год
2 23
"lblMonth"
""
1 268 262 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
23 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 268 262 307 277
0 2 2 "0s" 0 0 0 192 0 0  268 262 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 5 Month
LANG:10004 3 月
LANG:10000 5 Monat
LANG:10027 10 месяц
2 24
"lblDay"
""
1 218 262 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
24 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 220 262 251 277
0 2 2 "0s" 0 0 0 192 0 0  220 262 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 3 Day
LANG:10004 3 日
LANG:10000 3 Tag
LANG:10027 8 день
2 26
"lblCode"
""
1 375 262 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
26 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 377 262 456 277
0 2 2 "0s" 0 0 0 192 0 0  377 262 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 7 Weekday
LANG:10004 9 工作日
LANG:10000 4 Code
LANG:10027 21 День недели
2 27
"lblHoliday"
""
1 36 262 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
27 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 36 262 99 277
0 2 2 "0s" 0 0 0 192 0 0  36 262 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 7 Holiday
LANG:10004 6 假日
LANG:10000 9 Sondertag
LANG:10027 16 Выходной
2 31
"lblDataFill"
""
1 340 16 E E E 1 E 0 E N "_3DText" E N {255,255,153} E E
 E E
31 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"// Fill the table with data
main()
{
int           i;
dyn_string    name;          // Names of all special days
dyn_time      date;        // Dates of all special days
dyn_int       code;          // Weekdaycodes for all special days [0..8]
dyn_string  dsDays = spd_code.items;

  // Read the datasets for all special days from the comunications datapoint
  dpGet(\"TimeClkCom.specDayName:_original.._value\",     name,
        \"TimeClkCom.specDayDate:_original.._value\",     date,
        \"TimeClkCom.specDayCode:_original.._value\",     code);

  while( i < dynlen(name) )
  {
  i++;
  setValue(\"tab\", \"appendLine\", \"specDayName\", name[i],
                                \"specDayDate\", formatTime(\"%d.%m.%Y\",date[i]),  //Display in locale date-format
                                \"specDayRealDate\", date[i],          //Hidden column in internal date/time-format
                                \"specDayCode\", dsDays[code[i]]);


  setValue (\"aktivCol\", \"text\",  0);
  setValue (\"tab\",    \"cellBackColRC\", 0, \"specDayName\",  \"Schwarz\",
                      \"cellBackColRC\", 0, \"specDayDate\",  \"Schwarz\",
                      \"cellBackColRC\", 0, \"specDayCode\",  \"Schwarz\",
                      \"cellForeColRC\", 0, \"specDayName\",  \"_3DFace\",
                      \"cellForeColRC\", 0, \"specDayDate\",  \"_3DFace\",
                      \"cellForeColRC\", 0, \"specDayCode\",  \"_3DFace\"); 
 }
  
 if (dynlen(name) >= 1)
    { 
    setMultiValue(\"spd_name\", \"text\",name[1],
                  \"spd_year\", \"text\",year(date[1]),
                  \"spd_month\",\"text\",month(date[1]),
                  \"spd_day\",  \"text\",day(date[1]),
                  \"spd_code\", \"selectedPos\",code[1]);
    setValue(\"tab\",\"currentCell\",0,0);
    }
    else
    {
    setMultiValue(\"spd_name\", \"text\",\"\",
                  \"spd_year\", \"text\",year(getCurrentTime()),
                  \"spd_month\",\"text\",\"1\",
                  \"spd_day\",  \"text\",\"1\",
                  \"spd_code\", \"selectedPos\",8);
    }
}" 0
 E 0 1 1 0 1 E U  1 E 340 16 512 31
1 2 2 "0s" 0 0 0 192 0 0  340 16 1
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 4
LANG:10001 21 Fill table with data 
LANG:10004 21 用数据填充表格
LANG:10000 26 Tabelle mit Daten füllen 
LANG:10027 48 Заполнить таблицу данными
13 13
"Loeschen"
""
1 326 322 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
13 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  326 322 454 352

T 
4
LANG:10001 6 Delete
LANG:10004 6 删除
LANG:10000 8 Löschen
LANG:10027 14 Удалить
"main() 
// Zeile löschen
{
int col, row;   // Zeile und Spalte
string color;

getValue(\"aktivCol\", \"text\", row);
getValue (\"tab\", \"cellBackColRC\", row, \"specDayName\", color);
if (color == \"Schwarz\")
  {
  getValue(\"aktivCol\", \"text\", row);
  setValue(\"tab\", \"deleteLineN\", row);
  getValue(\"tab\", \"currentCell\", row, col);
  // Aktive Zeile setzen
  setValue (\"tab\",    \"cellBackColRC\", row, \"specDayName\", \"Schwarz\",
                      \"cellBackColRC\", row, \"specDayDate\", \"Schwarz\",
                      \"cellBackColRC\", row, \"specDayRealDate\", \"Schwarz\",
                      \"cellBackColRC\", row, \"specDayCode\", \"Schwarz\",
                      \"cellForeColRC\", row, \"specDayName\", \"_3DFace\",
                      \"cellForeColRC\", row, \"specDayDate\", \"_3DFace\",
                      \"cellForeColRC\", row, \"specDayRealDate\", \"_3DFace\",
                      \"cellForeColRC\", row, \"specDayCode\", \"_3DFace\");

  setValue(\"aktivCol\", \"text\", row);
  }
}
" 0
 E E E
13 14
"cmdCreate"
""
1 31 322 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
14 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  31 322 159 352

T 
4
LANG:10001 6 Create
LANG:10004 6 创建
LANG:10000 7 Anlegen
LANG:10027 14 Создать
"main()  
{
string        name, days, months, date_string,date;
dyn_string  datelist, date_split, namelist;
int         i, code,year,month,day, row, lineCount, rows, doublepos, actrow, actcol,oldrow;
dyn_string  dsDays = spd_code.items;


getMultiValue ( \"spd_name\",\"text\",name,
                \"spd_year\",\"text\",year,
                \"spd_month\",\"text\",month,
                \"spd_day\",\"text\",day,
                \"spd_code\",\"selectedPos\",code,
                \"aktivCol\",\"text\",row);               // active row  

sprintf(days,\"%0.2d\",day); 
sprintf(months,\"%0.2d\",month); 

date = days+\".\"+months+\".\"+year;

getValue(\"tab\", \"lineCount\", rows);

if (name != \"\")
   {
   getValue(\"tab\", \"currentCell\", oldrow, actcol);
   for (i = 1; i <= rows; i++)
       {
       getValue(\"tab\", \"cellValueRC\", i-1, \"specDayDate\", datelist[i]);
       getValue(\"tab\", \"cellValueRC\", i-1, \"specDayName\", namelist[i]);
       }
   if (!dynContains(datelist,days+\".\"+months+\".\"+year))  // if date or name not allready exists...
      {
      if (!dynContains(namelist,name))
         { 
         setValue(\"tab\", \"appendLine\", \"specDayName\",name,
                                       \"specDayDate\",date,
                                       \"specDayRealDate\",makeTime(year,months,days),         
                                       \"specDayCode\",dsDays[code]);
         getValue(\"tab\", \"currentCell\", actrow, actcol);
         doublepos = actrow;
         }
      else
         {
          doublepos = dynContains(namelist,name)-1;
          clk_warning(\"doubleSpecialDay\");
         }

       }
    else   // if date allready exist -> warning
       {
       clk_warning(\"doubleSpecialDay\");
       doublepos = dynContains(datelist,days+\".\"+months+\".\"+year)-1;
       }
    }
else
    {
    clk_warning(\"NamefieldEmpty\");
    }

// set line-selection to newline or in case of error to already existing row
setValue (\"tab\",\"cellBackColRC\", doublepos, \"specDayName\",  \"Schwarz\",
      \"cellForeColRC\", doublepos, \"specDayName\",  \"_3DFace\",
      \"cellBackColRC\", doublepos, \"specDayDate\",  \"Schwarz\",
      \"cellForeColRC\", doublepos, \"specDayDate\",  \"_3DFace\",
      \"cellBackColRC\", doublepos, \"specDayCode\",  \"Schwarz\",
      \"cellForeColRC\", doublepos, \"specDayCode\",  \"_3DFace\",
      \"cellBackColRC\", doublepos, \"specDayRealDate\", \"Schwarz\",
      \"cellForeColRC\", doublepos, \"specDayRealDate\",  \"_3DFace\",
      \"cellBackColRC\", oldrow, \"specDayName\",  \"_3DFace\",
      \"cellForeColRC\", oldrow, \"specDayName\",  \"Schwarz\",
      \"cellBackColRC\", oldrow, \"specDayDate\",  \"_3DFace\",
      \"cellForeColRC\", oldrow, \"specDayDate\",  \"Schwarz\",
      \"cellBackColRC\", oldrow, \"specDayCode\",  \"_3DFace\",
      \"cellForeColRC\", oldrow, \"specDayCode\",  \"Schwarz\",
      \"cellBackColRC\", oldrow, \"specDayRealDate\", \"_3DFace\",
      \"cellForeColRC\", oldrow, \"specDayRealDate\",  \"Schwarz\");

setValue(\"aktivCol\",\"text\",doublepos);
}
" 0
 E E E
13 15
"cmdSave"
""
1 178 358 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
15 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  178 358 306 388

T 
4
LANG:10001 9 Save list
LANG:10004 12 保存列表
LANG:10000 15 Liste speichern
LANG:10027 31 Сохранить список
"main()
// save data from table to datapoint
{
int          i, year, month, day, rows;
string         date_string;
dyn_int      code;
dyn_string   name, date_split;  
dyn_time     date;        
dyn_string  dsDays = spd_code.items;
string s;
 
 
setValue(\"tab\", \"sort\", \"specDayRealDate\");

// read data from the tabele, convert if necessary and write to datapoint
getValue(\"tab\", \"lineCount\", rows);

for (i = 1; i <= rows; i++)
    {
       {
       getValue(\"tab\",  \"cellValueRC\", i-1, \"specDayName\", name[i],
                        \"cellValueRC\", i-1, \"specDayCode\", s,
                        \"cellValueRC\", i-1, \"specDayDate\", date_string);
       code[i] = dynContains(dsDays, s);           
       date_split = strsplit(date_string,\".\");
       date[i] = makeTime(date_split[3],date_split[2],date_split[1]);
       }
    }  

  dpSet(\"TimeClkCom.specDayName:_original.._value\",name,
        \"TimeClkCom.specDayDate:_original.._value\",date,
        \"TimeClkCom.specDayCode:_original.._value\",code);
}" 0
 E E E
13 16
"cmdChange"
""
1 178 322 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
16 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  178 322 306 352

T 
4
LANG:10001 6 Change
LANG:10004 6 更改
LANG:10000 7 Ändern
LANG:10027 16 Изменить
"main()  
{
string        name, days, months, date_string,date;
int         i, code, year, month, day, row, actcol, actrow, rows, doublepos;
dyn_string  datelist, namelist;
dyn_string  dsDays = spd_code.items;


getMultiValue ( \"spd_name\",\"text\",name,
                \"spd_year\",\"text\",year,
                \"spd_month\",\"text\",month,
                \"spd_day\",\"text\",day,
                \"spd_code\",\"selectedPos\",code,
                \"aktivCol\",\"text\",row);               // active row  

sprintf(days,\"%0.2d\",day); 
sprintf(months,\"%0.2d\",month); 

date = days+\".\"+months+\".\"+year;

if (name != \"\")
    {
    getValue(\"tab\", \"currentCell\", actrow, actcol);
    getValue(\"tab\", \"lineCount\", rows);
    //DebugN(\"active row = \"+actrow+\"   active col = \"+actcol);
    for (i = 1; i <= rows; i++)
        {
        getValue(\"tab\", \"cellValueRC\", i-1, \"specDayDate\", datelist[i]);
        getValue(\"tab\", \"cellValueRC\", i-1, \"specDayName\", namelist[i]);
        }
    doublepos = dynContains(datelist,days+\".\"+months+\".\"+year)-1;
    if ((actrow == doublepos) || 
        (0 == dynContains(datelist,days+\".\"+months+\".\"+year)))  // if date not exist in other than actual row...
       {
       doublepos =  dynContains(namelist,name)-1;
       if ((actrow == doublepos) || (0 == dynContains(namelist,name)))
          { 
          setValue(\"tab\", \"cellValueRC\", row, \"specDayName\",name,
                          \"cellValueRC\", row, \"specDayDate\",date,
                          \"cellValueRC\", row, \"specDayRealDate\",makeTime(year,months,days), 
                          \"cellValueRC\", row, \"specDayCode\",dsDays[code]);
          doublepos = actrow;
          }
       else
          {
          clk_warning(\"doubleSpecialDay\");
          }
       }
    else   // if date allready exist -> warning
       {
       clk_warning(\"doubleSpecialDay\");
       }
    }
else  
    {
    clk_warning(\"NamefieldEmpty\");
    }
}
" 0
 E E E
25 17
"tab"
""
1 32 40 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
32 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  32 40 455 255
"main()
{
setValue(\"\",\"sortOnClick\",0);
}" 0
E 1 0 1 4 7 "specDayName" 20 1 0 "s" 4
LANG:10001 7 Holiday
LANG:10004 6 假日
LANG:10000 9 Sondertag
LANG:10027 16 Выходной
"main()
{
int newCol;   // New active column
int oldCol;   // Old active column
int row;   // 
dyn_string  dsDays = spd_code.items;

string    name;
string    date;
string     code;

dyn_string date_dyn;

  getValue(\"\", \"currentCell\",  newCol, row);
  getValue(\"aktivCol\", \"text\", oldCol);

   setValue (\"\",\"cellBackColRC\", newCol, \"specDayName\",  \"Schwarz\",
                \"cellForeColRC\", newCol, \"specDayName\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayDate\",  \"Schwarz\",
                \"cellForeColRC\", newCol, \"specDayDate\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayCode\",  \"Schwarz\",
                \"cellForeColRC\", newCol, \"specDayCode\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayRealDate\", \"Schwarz\",
                \"cellForeColRC\", newCol, \"specDayRealDate\",  \"_3DFace\",
                \"cellBackColRC\", oldCol, \"specDayName\",  \"_3DFace\",
                \"cellForeColRC\", oldCol, \"specDayName\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayDate\",  \"_3DFace\",
                \"cellForeColRC\", oldCol, \"specDayDate\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayCode\",  \"_3DFace\",
                \"cellForeColRC\", oldCol, \"specDayCode\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayRealDate\", \"_3DFace\",
                \"cellForeColRC\", oldCol, \"specDayRealDate\",  \"Schwarz\");

  // Aktive Zeile setzen wenn andere Zeile gewählt wurde
  if (newCol != oldCol)
  {
    setValue (\"aktivCol\", \"text\", newCol);

    getValue (   \"\",\"cellValueRC\",newCol,\"specDayName\",name,
         \"cellValueRC\",newCol,\"specDayDate\",date,
         \"cellValueRC\",newCol,\"specDayCode\",code);

   date_dyn = strsplit(date,\".\");
    
   setMultiValue (    \"spd_name\",\"text\",name,
                      \"spd_year\",\"text\",date_dyn[3],
                      \"spd_month\",\"text\",date_dyn[2],
                      \"spd_day\",\"text\",date_dyn[1],
                      \"spd_code\",\"text\",code);

  };
}" 0

3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

232 "specDayDate" 7 1 0 "s" 4
LANG:10001 4 Date
LANG:10004 6 日期
LANG:10000 5 Datum
LANG:10027 8 Дата
"main()
{
int newCol;	// New active column
int oldCol;	// Old active column
int row;	// 

string 	name;
string 	date;
string     code;

dyn_string date_dyn;

  getValue(\"\", \"currentCell\",  newCol, row);
  getValue(\"aktivCol\", \"text\", oldCol);

   setValue (\"\",\"cellBackColRC\", newCol, \"specDayName\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayName\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayDate\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayDate\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayCode\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayCode\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayRealDate\", \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayRealDate\",  \"_3DFace\",
		\"cellBackColRC\", oldCol, \"specDayName\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayName\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayDate\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayDate\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayCode\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayCode\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayRealDate\", \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayRealDate\",  \"Schwarz\");

  // Aktive Zeile setzen wenn andere Zeile gewählt wurde
  if (newCol != oldCol)
  {
    setValue (\"aktivCol\", \"text\", newCol);

    getValue (	\"\",\"cellValueRC\",newCol,\"specDayName\",name,
		   \"cellValueRC\",newCol,\"specDayDate\",date,
		   \"cellValueRC\",newCol,\"specDayCode\",code);

   date_dyn = strsplit(date,\".\");
    
   setMultiValue ( 	\"spd_name\",\"text\",name,
			\"spd_year\",\"text\",date_dyn[3],
                        \"spd_month\",\"text\",date_dyn[2],
                        \"spd_day\",\"text\",date_dyn[1],
			\"spd_code\",\"text\",code);

  };
}" 0

3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

88 "specDayCode" 6 1 0 "s" 4
LANG:10001 8 Day code
LANG:10004 9 日代码
LANG:10000 9 Tagescode
LANG:10027 13 Код дня
"main()
{
int newCol;	// New active column
int oldCol;	// Old active column
int row;	// 

string 	name;
string 	date;
string     code;

dyn_string date_dyn;

  getValue(\"\", \"currentCell\",  newCol, row);
  getValue(\"aktivCol\", \"text\", oldCol);

   setValue (\"\",\"cellBackColRC\", newCol, \"specDayName\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayName\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayDate\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayDate\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayCode\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayCode\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayRealDate\", \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayRealDate\",  \"_3DFace\",
		\"cellBackColRC\", oldCol, \"specDayName\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayName\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayDate\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayDate\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayCode\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayCode\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayRealDate\", \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayRealDate\",  \"Schwarz\");

  // Aktive Zeile setzen wenn andere Zeile gewählt wurde
  if (newCol != oldCol)
  {
    setValue (\"aktivCol\", \"text\", newCol);

    getValue (	\"\",\"cellValueRC\",newCol,\"specDayName\",name,
		   \"cellValueRC\",newCol,\"specDayDate\",date,
		   \"cellValueRC\",newCol,\"specDayCode\",code);

   date_dyn = strsplit(date,\".\");
    
   setMultiValue ( 	\"spd_name\",\"text\",name,
			\"spd_year\",\"text\",date_dyn[3],
                        \"spd_month\",\"text\",date_dyn[2],
                        \"spd_day\",\"text\",date_dyn[1],
			\"spd_code\",\"text\",code);

  };
}" 0

3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

80 "specDayRealDate" 18 0 0 "s" 4
LANG:10001 8 realDate
LANG:10004 6 日期
LANG:10000 8 realDate
LANG:10027 8 realDate
"main()
{
int newCol;	// New active column
int oldCol;	// Old active column
int row;	// 

string 	name;
string 	date;
string     code;

dyn_string date_dyn;

  getValue(\"\", \"currentCell\",  newCol, row);
  getValue(\"aktivCol\", \"text\", oldCol);

   setValue (\"\",\"cellBackColRC\", newCol, \"specDayName\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayName\",  \"_3DFace\",
                \"cellBackColRC\", newCol, \"specDayDate\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayDate\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayCode\",  \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayCode\",  \"_3DFace\",
		\"cellBackColRC\", newCol, \"specDayRealDate\", \"Schwarz\",
		\"cellForeColRC\", newCol, \"specDayRealDate\",  \"_3DFace\",
		\"cellBackColRC\", oldCol, \"specDayName\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayName\",  \"Schwarz\",
                \"cellBackColRC\", oldCol, \"specDayDate\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayDate\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayCode\",  \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayCode\",  \"Schwarz\",
		\"cellBackColRC\", oldCol, \"specDayRealDate\", \"_3DFace\",
		\"cellForeColRC\", oldCol, \"specDayRealDate\",  \"Schwarz\");

  // Aktive Zeile setzen wenn andere Zeile gewählt wurde
  if (newCol != oldCol)
  {
    setValue (\"aktivCol\", \"text\", newCol);

    getValue (	\"\",\"cellValueRC\",newCol,\"specDayName\",name,
		   \"cellValueRC\",newCol,\"specDayDate\",date,
		   \"cellValueRC\",newCol,\"specDayCode\",code);

   date_dyn = strsplit(date,\".\");
    
   setMultiValue ( 	\"spd_name\",\"text\",name,
			\"spd_year\",\"text\",date_dyn[3],
                        \"spd_month\",\"text\",date_dyn[2],
                        \"spd_day\",\"text\",date_dyn[1],
			\"spd_code\",\"text\",code);

  };
}" 0

3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

208 
26 26 "" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
"" 1 3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
8 72
4
LANG:10001 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0 0 2 1 1 7
1 0
14 18
"spd_name"
""
1 32 280 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
18 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  32 279 216 306
3 "0s" 0 0 0 0 0 -1  E E E
21 19
"spd_year"
""
1 314 280 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
19 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  312 279 375 306
0

E
E
E

N 1970 2038 1 1970 1 1
21 20
"spd_month"
""
1 265 280 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
20 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  265 279 313 306
0

E
E
E

N 1 12 1 1 1 1
21 21
"spd_day"
""
1 218 280 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
21 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  218 279 266 306
0

E
E
E

N 1 31 1 1 1 1
13 28
"cmdReread"
""
1 326 358 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
28 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  326 358 454 388

T 
4
LANG:10001 12 Reread list 
LANG:10004 12 重读列表
LANG:10000 15 Liste neu lesen
LANG:10027 33 Перечитать список
"main()
// Fill the table with data
{
int           i;
dyn_string    name;          // Names of all special days
dyn_time      date;        // Dates of all special days
dyn_int       code;          // Weekdaycodes for all special days [0..8]
dyn_string  dsDays = spd_code.items;

// clear table and input-fields...

setMultiValue(   \"tab\",\"deleteAllLines\",
      \"spd_name\",\"text\",\"\",
      \"spd_year\",\"text\",year(getCurrentTime()),
      \"spd_month\",\"text\",\"1\",
      \"spd_day\",\"text\",\"1\",
      \"spd_code\",\"selectedPos\",8,
      \"aktivCol\",\"text\",\"0\");


// fetch data from dp´s 
  dpGet(\"TimeClkCom.specDayName:_original.._value\",     name,
        \"TimeClkCom.specDayDate:_original.._value\",     date,
        \"TimeClkCom.specDayCode:_original.._value\",     code);

// fill the table
  while( i < dynlen(name) )
  {
  i++;
  setValue(\"tab\", \"appendLine\", \"specDayName\", name[i],
                                \"specDayDate\", formatTime(\"%d.%m.%Y\",date[i]),  //Display in locale date-format
                                \"specDayRealDate\", date[i],          //Hidden column in internal date/time-format
                                \"specDayCode\", dsDays[code[i]]);


  setValue (\"aktivCol\", \"text\",  0);
  setValue (\"tab\",    \"cellBackColRC\", 0, \"specDayName\",  \"Schwarz\",
                      \"cellBackColRC\", 0, \"specDayDate\",  \"Schwarz\",
                      \"cellBackColRC\", 0, \"specDayCode\",  \"Schwarz\",
                      \"cellForeColRC\", 0, \"specDayName\",  \"_3DFace\",
                      \"cellForeColRC\", 0, \"specDayDate\",  \"_3DFace\",
                      \"cellForeColRC\", 0, \"specDayCode\",  \"_3DFace\"); 
 }
  
 if (dynlen(name) >= 1)
    { 
    setMultiValue(\"spd_name\", \"text\",name[1],
                  \"spd_year\", \"text\",year(date[1]),
                \"spd_month\",\"text\",month(date[1]),
                  \"spd_day\",  \"text\",day(date[1]),
                  \"spd_code\", \"selectedPos\",code[1]);
    }
    else
    {
    setMultiValue(\"spd_name\", \"text\",\"\",
                  \"spd_year\", \"text\",year(getCurrentTime()),
                \"spd_month\",\"text\",\"1\",
                  \"spd_day\",  \"text\",\"1\",
                  \"spd_code\", \"selectedPos\",8);
    }
}" 0
 E E E
13 29
"cmdSort"
""
1 31 358 E E E 1 E 1 E N "Schwarz" E N "_Button" E E
 E E
29 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  31 358 159 388

T 
4
LANG:10001 4 Sort
LANG:10004 6 排序
LANG:10000 9 Sortieren
LANG:10027 22 Сортировать
"// sort by real time\\date string
main()
{
setValue(\"tab\",\"sort\",\"specDayRealDate\");
}" 0
 E E E
14 30
"aktivCol"
""
1 452 8 E E E 1 E 0 E N "_WindowText" E N {255,255,153} E E
 E E
30 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  452 8 482 41
2 "2d" 2 0 0 0 0 -1  E E E
22 32
"spd_code"
""
1 376 280 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
32 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  374 278 455 305
8
4
LANG:10001 3 Mon
LANG:10004 9 星期一
LANG:10000 3 Mon
LANG:10027 4 Пн

0
4
LANG:10001 3 Tue
LANG:10004 9 星期二
LANG:10000 3 Die
LANG:10027 4 Вт

0
4
LANG:10001 3 Wen
LANG:10004 3 Wen
LANG:10000 3 Mit
LANG:10027 4 Ср

0
4
LANG:10001 3 Thu
LANG:10004 9 星期四
LANG:10000 3 Don
LANG:10027 4 Чт

0
4
LANG:10001 3 Fri
LANG:10004 9 星期五
LANG:10000 3 Fre
LANG:10027 4 Пт

0
4
LANG:10001 3 Sat
LANG:10004 9 星期六
LANG:10000 3 Sam
LANG:10027 4 Сб

0
4
LANG:10001 3 Sun
LANG:10004 9 星期日
LANG:10000 3 Son
LANG:10027 4 Вс

0
4
LANG:10001 7 Holiday
LANG:10004 6 假日
LANG:10000 7 Spezial
LANG:10027 16 Выходной

0

E
E
E
 0 0
0
LAYER, 1 
4
LANG:10001 6 Layer2
LANG:10004 6 Layer2
LANG:10000 6 Layer2
LANG:10027 6 Layer2
0
LAYER, 2 
4
LANG:10001 6 Layer3
LANG:10004 6 Layer3
LANG:10000 6 Layer3
LANG:10027 6 Layer3
0
LAYER, 3 
4
LANG:10001 6 Layer4
LANG:10004 6 Layer4
LANG:10000 6 Layer4
LANG:10027 6 Layer4
0
LAYER, 4 
4
LANG:10001 6 Layer5
LANG:10004 6 Layer5
LANG:10000 6 Layer5
LANG:10027 6 Layer5
0
LAYER, 5 
4
LANG:10001 6 Layer6
LANG:10004 6 Layer6
LANG:10000 6 Layer6
LANG:10027 6 Layer6
0
LAYER, 6 
4
LANG:10001 6 Layer7
LANG:10004 6 Layer7
LANG:10000 6 Layer7
LANG:10027 6 Layer7
0
LAYER, 7 
4
LANG:10001 6 Layer8
LANG:10004 6 Layer8
LANG:10000 6 Layer8
LANG:10027 6 Layer8
0
0

V 13
4
LANG:10001 6 DpInfo
LANG:10004 6 DPInfo
LANG:10000 6 DpInfo
LANG:10027 6 DpInfo
PANEL,-1 -1 853 606 N "STD_panel_back" 3
"$b_Demo"
"$b_groupmode"
"$dpe_group"
"main()
{
}" 0
 E E E E 1 -1 -1 0  58 20
""0  1
E E 2
"CBRef" "1"
"EClose" E
0 0 0
""
NC
DISPLAY_LAYER, 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
LAYER, 0 
4
LANG:10001 6 Layer1
LANG:10004 6 Layer1
LANG:10000 6 Layer1
LANG:10027 6 Layer1
6 5
"Border4"
""
1 22 62 E E E 1 E 1 E N "STD_border_light" E N "_Transparent" E E
 E E
6 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 11 51 841 551
6 6
"Border2"
""
1 20 60 E E E 1 E 1 E N "STD_border_dark" E N "_Transparent" E E
 E E
7 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

2
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 10 50 840 550
2 90
"Filter"
""
1 640 94 E E E 1 E 1 E N "STD_text" E N "_Transparent" E E
 E E
7 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 642 94 755 109
0 2 2 "0s" 0 0 0 192 0 0  642 94 1
4
LANG:10001 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 20 Number of elements :
LANG:10004 13 元素数量:
LANG:10000 20 Anzahl der Elemente:
LANG:10027 31 Кол-во элементов:
2 92
"header"
""
1 10 10 E E E 1 E 1 E N "STD_text" E N "_Transparent" E E
 E E
9 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 12 12 338 32
0 2 2 "0s" 0 0 0 192 0 0  12 12 1
4
LANG:10001 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,18,5,40,0,0,0,0,0
0 4
LANG:10001 29 Datapoint Info/Current values
LANG:10004 15 DP/当前数值
LANG:10000 36 Datenpunkt Auskunft / Aktuelle Werte
LANG:10027 60 Информация по DP/Текущие значения
2 94
"Text3"
""
1 20 62 E E E 1 E 1 E N "STD_text" E N "_Transparent" E E
 E E
11 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 22 62 70 77
0 2 2 "0s" 0 0 0 192 0 0  22 62 1
4
LANG:10001 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 7 Group :
LANG:10004 6 组：
LANG:10000 7 Gruppe:
LANG:10027 13 Группа:
2 97
"Text4"
""
1 443 62 E E E 1 E 1 E N "STD_text" E N "_Transparent" E E
 E E
14 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 445 62 539 77
0 2 2 "0s" 0 0 0 192 0 0  445 62 1
4
LANG:10001 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 14 Name pattern :
LANG:10004 13 名称样式:
LANG:10000 13 Namensmuster:
LANG:10027 25 Образец имени
2 101
"waitText"
""
1 330 312 E E E 1 E 1 E N "_ButtonShadow" E N "_Transparent" E E
 E E
18 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 332 312 562 332
0 2 2 "0s" 0 0 0 192 0 0  332 312 1
4
LANG:10001 26 arial,-1,18,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,18,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,18,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,18,5,50,0,0,0,0,0
0 4
LANG:10001 15 Please wait ...
LANG:10004 13 请稍候 ...
LANG:10000 17 Bitte warten ....
LANG:10027 45 Пожалуйста, подождите ....
2 102
"dateTime"
""
1 420 11 E E E 1 E 1 E N "STD_text" E N "_Transparent" E E
 E E
19 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"sizePolicy" "Fixed Fixed"
"dashclr"N "_Transparent"
"antiAliased" "0"
"main()
{
    setValue(\"\",\"text\",formatTime(\"%c\", getCurrentTime () ) );
}" 0
 E 0 1 1 0 1 E U  0 E 422 13 838 35
0 2 2 "0s" 0 0 0 66 0 0  422 13 1
4
LANG:10001 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,18,5,40,0,0,0,0,0
0 4
LANG:10001 17 20.05.01 12:00:00
LANG:10004 17 20.05.01 12:00:00
LANG:10000 17 20.05.01 12:00:00
LANG:10027 17 20.05.01 12:00:00
13 85
"cmdCancel"
""
1 1023 1328 E E E 1 E 1 E N "STD_button_text" E N "STD_pushbutton_back" E E
 E E
1 0 0 0 27 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  628 558 732 588

T 
4
LANG:10001 5 Close
LANG:10004 6 关闭
LANG:10000 10 Schließen
LANG:10027 14 Закрыть
"main()
{
  PanelOff();
}" 0
 E E E
13 86
"cmdHelp"
""
1 1458 1328 E E E 1 E 1 E N "STD_button_text" E N "STD_pushbutton_back" E E
 E E
2 0 0 0 112 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  738 558 842 588

T 
4
LANG:10001 4 Help
LANG:10004 6 帮助
LANG:10000 5 Hilfe
LANG:10027 14 Справка
"main()
{
  std_help(\"da_dpe_group\");
}
" 0
 E E E
25 87
"tabInfo"
""
1 20 120 E E E 1 E 0 E N "STD_text" E N "STD_panel_back" E E
 E E
3 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,10,-1,5,50,0,0,0,0,0
0  18 118 832 542
"main()
{
  //On initializing get dpe´s 
  //and put them into table \"tabInfo\"
  
  dyn_string  dpGroupNames, dsComment, dsBits;
  string      dpName, nameOrComment, dummyString,
              sDpeGroup=(isDollarDefined(\"$dpe_group\"))?$dpe_group:\"\",
              sManName;
  int         i, j;
  bool        bFound;
  bit32       status;
  char        cDefault, cOut_prange, cInvalid, cFrom_GI, cUserbit1, cUserbit2;
  dyn_dyn_anytype queryTab;
  
  //get the bit identifier from language catalogue
  cDefault    = getCatStr(\"sc\", \"default\");
  cOut_prange = getCatStr(\"sc\", \"out_prange\");
  cInvalid    = getCatStr(\"sc\", \"invalid\");
  cFrom_GI    = getCatStr(\"sc\", \"from_GI\");
  cUserbit1   = '1';
  cUserbit2   = '2';
  //get all defined groups of DPs
  dpGroupNames = groupGetNames();
  
  bFound = FALSE;
  for(i = 1; i <= dynlen(dpGroupNames); i++)
  {
    //get the _DPGroup... name for a group
    dpName =  groupNameToDpName(dpGroupNames[i]);
    //get the group name e.g. \"Alerts\", \"States\", etc.
    dsComment = dpGetComment(dpName+\".:_common.\");
    
    for(j = 1; j <= dynlen(dsComment); j++)
      if(dsComment[j] == sDpeGroup)
        bFound = TRUE;
    if(bFound)
      break;            
  }
  
  if(!bFound)
  {
    //if nothing corresponding to given group
    waitText.visible = FALSE;
    tabInfo.visible(TRUE);
    elementsCount.text = tabInfo.lineCount();
    return;
  }
  //get dp name without system identifier
  dpName = dpSubStr (dpName,DPSUB_DP_EL_CONF_DET_ATT);
  dpQuery(\"SELECT '_original.._value', '_original.._stime','_original.._status','_original.._user','_original.._manager' FROM '{DPGROUP(\"+dpName+\")}'\",queryTab);
 
  dsComment = makeDynString();
  //fill up table
  for (i=2; i<=dynlen(queryTab);i++)
  {
    dummyString = queryTab[i][1];
   	if (strpos(dummyString,\"mp_\") < 0)
   	{
   	  //get comment of dp
      dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
      if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
      //build status / user bits
      sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
      (dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
      (dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
      (dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
      (dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
      (dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
      (dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
      convManIntToName(queryTab[i][6], sManName);
      dpName = queryTab[i][1];
      this.appendLine(\"dpe\",      dpName,
                      \"dpname\",   dpName,
                  	  \"dpcomment\",dsComment[i],
                      \"text\",     queryTab[i][2],
                      \"user\",     getUserName(queryTab[i][5]),
                      \"manager\",  sManName,
                      \"bits\",     dsBits[i],
                      \"time\",     queryTab[i][3],
                      \"detail\",   \"...\");
    } 
  }
  //if entries made into table, set table visible
  if(this.lineCount() > 0)
  {
    if(!checkComment.state(0))
    {
      for(i = 0; i < this.lineCount(); i++)
      {
        //do only if DP comment existing
        nameOrComment = this.cellValueRC(i,\"dpcomment\");
        if(strlen(nameOrComment) > 0)
        {
          //swap DP name with DP comment
          this.cellValueRC(i,\"dpcomment\",this.cellValueRC(i,\"dpname\"));
          this.cellValueRC(i,\"dpname\",nameOrComment);
        }
      }
    }
  }
  tabInfo.visible(TRUE);
  elementsCount.text = tabInfo.lineCount();
}" 0
"main()
{
  int    x, y;
  string dpName;
  
  getValue(\"\",\"currentCell\",x,y);
  
  //check for column \"detail\"
  if(this.columnToName(y) != \"detail\")
    return;
    
  getValue(\"\",\"cellValueRC\",x,\"dpe\",dpName);
  if((!dpExists(dpName+\":_online.._value\")) || (dpElementType(dpName)==1))
  {
    string sMessageText=getCatStr(\"misc\",\"DpeNotExisting\");
    ChildPanelOnModal(\"vision/MessageWarning\",getCatStr(\"para\",\"warning\"),makeDynString(sMessageText),50,50);
    return;    
  }
   
  ChildPanelOnCentralModal (\"vision/dpe_info.pnl\",
                            getCatStr(\"misc\",\"title_of_dpe_info\"),
                            makeDynString(\"$b_editable:FALSE\",\"$dpe:\"+dpName));
    
}" 0
 1 0 1 10 1 "dpe" 20 0 0 "s" 4
LANG:10001 30 Datenpunktelement/Beschreibung
LANG:10004 10 DPE/描述
LANG:10000 3 dpe
LANG:10027 3 dpe
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

229 "dpname" 21 1 0 "s" 4
LANG:10001 17 Datapoint/Comment
LANG:10004 9 DP/备注
LANG:10000 30 Datenpunktelement/Beschreibung
LANG:10027 63 Элемент точки данных / комментарий
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

240 "dpcomment" 2 0 0 "s" 4
LANG:10001 6 dpname
LANG:10004 6 dpname
LANG:10000 9 dpcomment
LANG:10027 6 dpname
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

30 "text" 12 1 0 "s" 4
LANG:10001 5 Value
LANG:10004 6 数值
LANG:10000 13 Wert / Inhalt
LANG:10027 39 Значение / содержание
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

150 "user" 7 1 0 "s" 4
LANG:10001 4 Bits
LANG:10004 4 Bits
LANG:10000 8 Benutzer
LANG:10027 24 Пользователь
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

90 "manager" 6 1 0 "s" 4
LANG:10001 4 Bits
LANG:10004 4 Bits
LANG:10000 7 Manager
LANG:10027 16 Менеджер
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

80 "bits" 6 1 0 "s" 4
LANG:10001 4 Bits
LANG:10004 4 Bits
LANG:10000 4 Bits
LANG:10027 8 Биты
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

80 "time" 11 1 0 "s" 4
LANG:10001 4 Time
LANG:10004 6 时间
LANG:10000 4 Zeit
LANG:10027 10 Время
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

130 "detail" 1 1 0 "s" 4
LANG:10001 3 ...
LANG:10004 3 ...
LANG:10000 3 ...
LANG:10027 3 ...
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

22 "value" 1 0 0 "s" 4
LANG:10001 5 value
LANG:10004 5 value
LANG:10000 5 value
LANG:10027 16 значение
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

26 
26 26 "" 1 4
LANG:10001 2 #1
LANG:10004 2 #1
LANG:10000 2 #1
LANG:10027 2 #1
8 30
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,10,-1,5,50,0,0,0,0,0
0 0 2 0 1 7
1 0
20 88
"checkComment"
""
1 20 560 E E E 1 E 1 E N "STD_text" E N "STD_panel_back" E E
 E E
4 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0  18 558 232 582
1
T 
4
LANG:10001 14 DPE names only
LANG:10004 13 仅DPE 名称
LANG:10000 20 Nur DPE-Beschreibung
LANG:10027 27 Только имена DPE

0 
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
E E
0 0 0 0 0
1
E E
E"main()
{
  //This toggles the 1st column of table between
  //DP Name and DP Comment
  shape    table = getShape(\"tabInfo\");
  int      i;
  string   s1, s2;
  
  for(i = 0; i < table.lineCount(); i++)
  {
    s1 = table.cellValueRC(i,\"dpname\");
    s2 = table.cellValueRC(i,\"dpcomment\");
    //swap DP name with DP comment
    table.cellValueRC(i,\"dpcomment\",s1);
    table.cellValueRC(i,\"dpname\",s2);
  }
}" 0
22 91
"groupSelector"
""
1 75 58 E E E 1 E 1 E N "STD_inputfield_text" E N "STD_inputfield_back" E E
 E E
8 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10027 26 arial,-1,12,5,40,0,0,0,0,0
0  73 56 362 82
1
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0

"main()
{
  //On initializing setup the groupnames 
  //and put them into combobox \"groupSelector\"
  
  dyn_string dpGroupNames, dsComment;
  int        i, j;            
  bool       bFound = FALSE;
  string     dpName, sDpeGroup=(isDollarDefined(\"$dpe_group\"))?$dpe_group:\"\";
 
  dpGroupNames = groupGetNames();
  this.enabled = (isDollarDefined(\"$b_groupmode\"))?$b_groupmode:true;
    
  for(i = 1; i <= dynlen(dpGroupNames); i++)
  {
    //get the _DPGroup... name for a group
    dpName =  groupNameToDpName(dpGroupNames[i]);
    //get the group name e.g. \"Alerts\", \"States\", etc.
    dsComment = dpGetComment(dpName+\".:_common.\");
    
    for(j = 1; j <= dynlen(dsComment); j++)
      if(dsComment[j] == sDpeGroup)
        bFound = TRUE;
    if(bFound)
      break;            
  }
  
  this.items = dpGroupNames;
  if(!bFound)
    //if nothing corresponding to given group
    return;
  if(i > 0) 
  {
    this.selectedPos = i;
  }
}" 0

"main()
{
  //On eventChange get dpe´s 
  //and put them into table \"tabInfo\"
  dyn_string  dpGroupNames, dsComment, dsBits;
  string      dpName, nameOrComment, dummyString,
              sManName;       
  int         i, j;
  bool        bFound;
  bit32       status;
  char        cDefault, cOut_prange, cInvalid, cFrom_GI, cUserbit1, cUserbit2;
  dyn_dyn_anytype queryTab;
  shape       table       = getShape(\"tabInfo\");
  string      grpSelector = this.text;
  
  check_mps.visible = true;
  namePatternSelector.text = \"*\";
  //get the current time, format and display
  setValue(\"dateTime\",\"text\",formatTime(\"%c\", getCurrentTime () ) );
  //get the bit identifier from language catalogue
  cDefault    = getCatStr(\"sc\", \"default\");
  cOut_prange = getCatStr(\"sc\", \"out_prange\");
  cInvalid    = getCatStr(\"sc\", \"invalid\");
  cFrom_GI    = getCatStr(\"sc\", \"from_GI\");
  cUserbit1   = '1';
  cUserbit2   = '2';
  //delete all lines of table
  elementsCount.text = \"\";
  table.visible(FALSE);
  table.deleteAllLines();
  waitText.visible = TRUE;
  //get all defined groups of DPs
  dpGroupNames = groupGetNames();
  
  bFound = FALSE;
  for(i = 1; i <= dynlen(dpGroupNames); i++)
  {
    //get the _DPGroup... name for a group
    dpName =  groupNameToDpName(dpGroupNames[i]);
    //get the group name e.g. \"Alerts\", \"States\", etc.
    dsComment = dpGetComment(dpName+\".:_common.\");
    
    for(j = 1; j <= dynlen(dsComment); j++)
      if(dsComment[j] == grpSelector)
        bFound = TRUE;
    if(bFound)
      break;            
  }
  
  if(!bFound)
  {
    //if nothing corresponding to given group
    waitText.visible = FALSE;
    tabInfo.visible(TRUE);
    elementsCount.text = tabInfo.lineCount();
    return;
  }
  //get dp name without system identifier
  dpName = dpSubStr (dpName,DPSUB_DP_EL_CONF_DET_ATT);
  dpQuery(\"SELECT '_original.._value', '_original.._stime','_original.._status','_original.._user','_original.._manager' FROM '{DPGROUP(\"+dpName+\")}'\",queryTab);
 
  dsComment = makeDynString();
  //fill up table
  for (i=2; i<=dynlen(queryTab);i++)
  {
	if (check_mps.state(0)== 0)
      {
        dummyString = queryTab[i][1];
   		if (strpos(dummyString,\"mp_\") < 0)
   		{
   		  //get comment of dp
          dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
          if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
      	  //build status / user bits
      	  sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
          (dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
          (dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
          (dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
          (dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
          (dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
          (dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
          
          convManIntToName(queryTab[i][6], sManName);
          dpName = queryTab[i][1];
          dummyString = queryTab[i][2];
      	  tabInfo.appendLine(\"dpe\",      dpName,
                    		 \"dpname\",   dpName,
                      		 \"dpcomment\",dsComment[i],
                      		 \"text\",     dummyString,
                      		 \"user\",     getUserName(queryTab[i][5]),
                             \"manager\",  sManName,
                      		 \"bits\",     dsBits[i],
                      		 \"time\",     queryTab[i][3],
                      		 \"detail\",   \"...\");
        }
      }
      if (check_mps.state(0)== 1) 
      {
   		//get comment of dp
        dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
        if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
      	//build status / user bits
      	sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
        (dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
        (dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
        (dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
        (dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
        (dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
        (dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
      
      	dpName = queryTab[i][1];
        dummyString = queryTab[i][2];
      	tabInfo.appendLine(\"dpe\",      dpName,
                	       \"dpname\",   dpName,
                      	   \"dpcomment\",dsComment[i],
                      	   \"text\",     dummyString,
                      	   \"bits\",     dsBits[i],
                      	   \"time\",     queryTab[i][3],
                      	   \"detail\",   \"...\");
    			
      }  
  }
  //if entries made into table, set table visible
  if(table.lineCount() > 0)
  {
    if(!checkComment.state(0))
    {
      for(i = 0; i < table.lineCount(); i++)
      {
        //do only if DP comment existing
        nameOrComment = table.cellValueRC(i,\"dpcomment\");
        if(strlen(nameOrComment) > 0)
        {
          //swap DP name with DP comment
          table.cellValueRC(i,\"dpcomment\",table.cellValueRC(i,\"dpname\"));
          table.cellValueRC(i,\"dpname\",nameOrComment);
        }
      }
    }
  }
  tabInfo.visible(TRUE);
  elementsCount.text = tabInfo.lineCount();
}
" 0

E
 0 0
14 95
"elementsCount"
""
1 774 90 E E E 1 E 1 E N "STD_textfield_text" E N "STD_textfield_back" E E
 E E
12 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0  772 88 832 115
2 "0s" 0 0 0 0 0 -1  E E E
13 96
"Button1"
""
1 913 1328 E E E 1 E 1 E N "STD_button_text" E N "STD_pushbutton_back" E E
 E E
13 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10004 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10000 26 arial,-1,13,5,50,0,0,0,0,0
LANG:10027 26 arial,-1,13,5,50,0,0,0,0,0
0  518 558 622 588

T 
4
LANG:10001 5 Print
LANG:10004 6 打印
LANG:10000 7 Drucken
LANG:10027 12 Печать
"main()
{
  //print this panel
  // \\date \\time \\page \\name \\user \\numpages \\tablehead
  // makeDynString(\"Datum: \\\\date\",\"\\\\tablehead\");
  
  dyn_string sHeader = makeDynString(header.text(),
                               ( (groupSelector.text() == \"\") ? namePatternSelector.text : groupSelector.text) + 
                                   \" : \\\\date \\\\time\",\"\\\\tablehead\");
  dyn_string sFooter = makeDynString();
  setValue(\"tabInfo\", \"printTable\",
            sHeader,
            makeDynString(),   // no special column attributes
            sFooter,
            \"PCL.cfg\",         // config-file 
            PAPER_FORMAT_A4,
            false,             // portrait
            false,             // all visible columns
            '|',               // delimiter
            0,                 // no leftSpace 
            0);                // no lineSpace
}" 0
 E E E
22 98
"namePatternSelector"
""
1 545 60 E E E 1 E 1 E N "STD_inputfield_text" E N "STD_inputfield_back" E E
 E E
15 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,12,5,40,0,0,0,0,0
LANG:10027 26 arial,-1,12,5,40,0,0,0,0,0
0  543 58 832 84
0

E
"main()
{
  //On eventChange get dpe´s 
  //and put them into table \"tabInfo\"
  dyn_string  dsComment, dsBits, resultText, dsEntries;
  dyn_float   resultFloat;
  string      dpName, nameOrComment, dummyString,
              sManName;       
  int         i;
  bit32       status;
  char        cDefault, cOut_prange, cInvalid, cFrom_GI, cUserbit1, cUserbit2;
  dyn_dyn_anytype queryTab;
  shape       table = getShape(\"tabInfo\");
  string      namePattern;
  string      testPattern;
  
  bool        bDemo = FALSE;
  
  check_mps.visible = FALSE;
  //place any new entry into combobox  
  this.appendItem(this.text);
  dsEntries = this.items();
  dynUnique(dsEntries);
  this.items(dsEntries);
  namePattern = this.text();
  //remove system identifier
  if((i = strpos(namePattern,\":\")) > 0)
    if(strlen(namePattern) > (i + 1))
      namePattern = substr(namePattern,i+1);
  if((i = strpos(namePattern,\":\")) > 0)
    namePattern = substr(namePattern,0,i);
    
  //check pattern
  testPattern = namePattern;
  strreplace (testPattern,\"*\",\" \");
  strreplace (testPattern,\"_\",\" \");
  strreplace (testPattern,\".\",\" \");
  testPattern = strltrim(strrtrim(testPattern));
  if(strlen(testPattern) == 0)
  {
    if(isDollarDefined(\"$b_Demo\"))
      bDemo = $b_Demo;
    if(bDemo == FALSE)
    {
      if(getUserPermission(4)) //user is authorized
         ChildPanelOnCentralModalReturn(\"vision/MessageWarning2\",
                                      getCatStr(\"general\",\"warning\"),
                                      makeDynString(\"$1:\"+getCatStr(\"misc\",\"veryMuch\"),
                                                    \"$2:\"+getCatStr(\"general\",\"OK\"),
                                                    \"$3:\"+getCatStr(\"general\",\"cancel\")),
                                      resultFloat,
                                      resultText );
      else					//user not authorized
      {
         ChildPanelOnCentralModal(\"vision/MessageWarning\",
                                      getCatStr(\"general\",\"warning\"),
                                      makeDynString(\"$1:\"+getCatStr(\"misc\",\"userNotAllowed\"),
                                                    \"$2:\"+getCatStr(\"general\",\"OK\"),
                                                    \"$3:\"+getCatStr(\"general\",\"cancel\")) );
         return;
      }
    }
    else
    {
         ChildPanelOnCentralModalReturn(\"vision/MessageDeadEnd.pnl\",
    								getCatStr(\"sc\",\"attention\"),makeDynString(\"$1:\"+getCatStr(\"misc\",\"veryMuch\")),
    								resultFloat,
    								resultText);	
       return;
    }
        
    if(resultText == \"false\")
    {
      this.text = \"\";
      return;
    }
  }
  groupSelector.text = \"\";
  //get the current time, format and display
  setValue(\"dateTime\",\"text\",formatTime(\"%c\", getCurrentTime () ) );
  //get the bit identifier from language catalogue
  cDefault    = getCatStr(\"sc\", \"default\");
  cOut_prange = getCatStr(\"sc\", \"out_prange\");
  cInvalid    = getCatStr(\"sc\", \"invalid\");
  cFrom_GI    = getCatStr(\"sc\", \"from_GI\");
  cUserbit1   = '1';
  cUserbit2   = '2';
  //delete all lines of table
  elementsCount.text = \"\";
  table.visible(FALSE);
  table.deleteAllLines();
  waitText.visible = TRUE;
  getValue(\"\",\"text\",dpName);
  dpQuery(\"SELECT '_original.._value', '_original.._stime','_original.._status','_original.._user','_original.._manager' FROM '\"+dpName+\"' WHERE _LEAF\",queryTab);
  dsComment = makeDynString();
  //fill up table
  for (i=2; i<=dynlen(queryTab);i++)
  {
    dummyString = queryTab[i][1];
   	if (strpos(dummyString,\"mp_\") < 0)
   	{
   	  //get comment of dp
      dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
      if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
      //build status / user bits
      sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
      (dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
      (dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
      (dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
      (dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
      (dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
      (dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
      
      convManIntToName(queryTab[i][6], sManName);
      dpName = queryTab[i][1];
      dummyString = queryTab[i][2];
      tabInfo.appendLine(\"dpe\",      dpName,
                      \"dpname\",   dpName,
                  	  \"dpcomment\",dsComment[i],
                      \"text\",     dummyString,
                      \"user\",     getUserName(queryTab[i][5]),
                      \"manager\",  sManName,
                      \"bits\",     dsBits[i],
                      \"time\",     queryTab[i][3],
                      \"detail\",   \"...\");
    } 
  }
  //if entries made into table, set table visible
  if(table.lineCount() > 0)
  {
    if(!checkComment.state(0))
    {
      for(i = 0; i < table.lineCount(); i++)
      {
        //do only if DP comment existing
        nameOrComment = table.cellValueRC(i,\"dpcomment\");
        if(strlen(nameOrComment) > 0)
        {
          //swap DP name with DP comment
          table.cellValueRC(i,\"dpcomment\",table.cellValueRC(i,\"dpname\"));
          table.cellValueRC(i,\"dpname\",nameOrComment);
        }
      }
    }
  }
  tabInfo.visible(TRUE);
  elementsCount.text = tabInfo.lineCount();
}
" 0

E
 1 0
20 106
"check_mps"
""
1 240 560 E E E 1 E 0 E N "_3DText" E N "_3DFace" E E
 E E
22 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

0
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0  238 558 432 582
1
T 
4
LANG:10001 22 Show master datapoints
LANG:10004 11 显示主DP
LANG:10000 26 Musterdatenpunkte anzeigen
LANG:10027 36 Показывать мастер-DP

0 
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 
E E
0 0 0 0 0
1
E E
E"main(int number, bool state)
{
  //On initializing get dpe´s 
  //and put them into table \"tabInfo\"
  
  dyn_string  dpGroupNames, dsComment, dsBits;
  string      dpName, nameOrComment, dummyString,
              sDpeGroup=groupSelector.text,
              sManName;       
  int         i, j;
  bool        bFound;
  bit32       status;
  char        cDefault, cOut_prange, cInvalid, cFrom_GI, cUserbit1, cUserbit2;
 
  dyn_dyn_anytype queryTab;
 
  string      grpSelector = groupSelector.text;
   
  //Clear Tab
  tabInfo.visible = FALSE;  
  tabInfo.deleteAllLines();
  
  //get the bit identifier from language catalogue
  cDefault    = getCatStr(\"sc\", \"default\");
  cOut_prange = getCatStr(\"sc\", \"out_prange\");
  cInvalid    = getCatStr(\"sc\", \"invalid\");
  cFrom_GI    = getCatStr(\"sc\", \"from_GI\");
  cUserbit1   = '1';
  cUserbit2   = '2';
  //get all defined groups of DPs
  dpGroupNames = groupGetNames();
  
  bFound = FALSE;
  for(i = 1; i <= dynlen(dpGroupNames); i++)
  {
    //get the _DPGroup... name for a group
    dpName =  groupNameToDpName(dpGroupNames[i]);
    //get the group name e.g. \"Alerts\", \"States\", etc.
    dsComment = dpGetComment(dpName+\".:_common.\");
    
    for(j = 1; j <= dynlen(dsComment); j++)
      if(dsComment[j] == sDpeGroup || dsComment[j] == grpSelector)
        bFound = TRUE;
    if(bFound)      
      break;           
  }
  
  if(!bFound)
  {
    //if nothing corresponding to given group
    waitText.visible = FALSE;
    this.state(0) = 0;
    tabInfo.visible(TRUE);
    elementsCount.text = tabInfo.lineCount();
    return;
  }
  //get dp name without system identifier
  dpName = dpSubStr (dpName,DPSUB_DP_EL_CONF_DET_ATT);
  dpQuery(\"SELECT '_original.._value', '_original.._stime','_original.._status','_original.._user','_original.._manager' FROM '{DPGROUP(\"+dpName+\")}'\",queryTab);
 
  dsComment = makeDynString();
  //fill up table
  for (i=2; i<=dynlen(queryTab);i++)
  {
//    switch(state)
    switch(number)
    {
      case(0): if (state == 0) 
               {
                 dummyString = queryTab[i][1];
   				 if (strpos(dummyString,\"mp_\") < 0)
   				 {
   				   	//get comment of dp
      			   	dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
                    if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
     				//build status / user bits
      				sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
        			(dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
        			(dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
        			(dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
        			(dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
        			(dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
        			(dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
        			
                    convManIntToName(queryTab[i][6], sManName);
      				dpName = queryTab[i][1];
      				tabInfo.appendLine(\"dpe\",      dpName,
                      					\"dpname\",   dpName,
                      					\"dpcomment\",dsComment[i],
                      					\"text\",     queryTab[i][2],
                      					\"user\",     getUserName(queryTab[i][5]),
                                        \"manager\",  sManName,
                      					\"bits\",     dsBits[i],
                      					\"time\",     queryTab[i][3],
                      					\"detail\",   \"...\");
    			}
              }
      case(0): if (state == 1) 
               {
   				 //get comment of dp
                 dsComment[i] = dpGetComment(queryTab[i][1]+\":_common.\");
                 if (strrtrim(strltrim(dsComment[i])) == \"\") dsComment[i] = queryTab[i][1];
      		     //build status / user bits
      			 sprintf(dsBits[i], \"%c%c%c%c%c%c\", 
        		 (dpGetStatusBit(status, \":_online.._default\")    == 1) ? cDefault    : '-',
        		 (dpGetStatusBit(status, \":_online.._out_prange\") == 1) ? cOut_prange : '-',
        		 (dpGetStatusBit(status, \":_online.._invalid\")    == 1) ? cInvalid    : '-',
        		 (dpGetStatusBit(status, \":_online.._from_GI\")    == 1) ? cFrom_GI    : '-',
        		 (dpGetStatusBit(status, \":_online.._userbit1\")   == 1) ? cUserbit1   : '-',
        		 (dpGetStatusBit(status, \":_online.._userbit2\")   == 1) ? cUserbit2   : '-');
                 
                 convManIntToName(queryTab[i][6], sManName);
      			 dpName = queryTab[i][1];
      			 tabInfo.appendLine(\"dpe\",      dpName,
                    				\"dpname\",   dpName,
                      				\"dpcomment\",dsComment[i],
                      				\"text\",     queryTab[i][2],
                      				\"user\",     getUserName(queryTab[i][5]),
                                    \"manager\",  sManName,
                      				\"bits\",     dsBits[i],
                      				\"time\",     queryTab[i][3],
                      				\"detail\",   \"...\");
    			
              }  
     }
  }
  //if entries made into table, set table visible
  if(tabInfo.lineCount() > 0)
  {
    if(!checkComment.state(0))
    {
      for(i = 0; i < tabInfo.lineCount(); i++)
      {
        //do only if DP comment existing
        nameOrComment = tabInfo.cellValueRC(i,\"dpcomment\");
        if(strlen(nameOrComment) > 0)
        {
          //swap DP name with DP comment
          tabInfo.cellValueRC(i,\"dpcomment\",tabInfo.cellValueRC(i,\"dpname\"));
          tabInfo.cellValueRC(i,\"dpname\",nameOrComment);
        }
      }
    }
  }
  tabInfo.visible(TRUE);
  elementsCount.text = tabInfo.lineCount();
}" 0
0
LAYER, 1 
4
LANG:10001 6 Layer2
LANG:10004 6 Layer2
LANG:10000 6 Layer2
LANG:10027 6 Layer2
0
LAYER, 2 
4
LANG:10001 6 Layer3
LANG:10004 6 Layer3
LANG:10000 6 Layer3
LANG:10027 6 Layer3
0
LAYER, 3 
4
LANG:10001 6 Layer4
LANG:10004 6 Layer4
LANG:10000 6 Layer4
LANG:10027 6 Layer4
0
LAYER, 4 
4
LANG:10001 6 Layer5
LANG:10004 6 Layer5
LANG:10000 6 Layer5
LANG:10027 6 Layer5
0
LAYER, 5 
4
LANG:10001 6 Layer6
LANG:10004 6 Layer6
LANG:10000 6 Layer6
LANG:10027 6 Layer6
0
LAYER, 6 
4
LANG:10001 6 Layer7
LANG:10004 6 Layer7
LANG:10000 6 Layer7
LANG:10027 6 Layer7
0
LAYER, 7 
4
LANG:10001 6 Layer8
LANG:10004 6 Layer8
LANG:10000 6 Layer8
LANG:10027 6 Layer8
0
0

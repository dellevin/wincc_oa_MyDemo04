V 14
4
LANG:10001 4 Data
LANG:10004 4 Data
LANG:10000 5 Daten
LANG:10027 12 Данные
PANEL,-1 -1 900 519 N "_3DFace" 0
E E E E E 1 -1 -1 0  954 456
""0  1
E E 3
"CBRef" "1"
"EClose" E
"dpi" "96"
0 0 0
""
DISPLAY_LAYER, 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
LAYER, 0 
4
LANG:10001 6 Layer1
LANG:10004 6 Layer1
LANG:10000 6 Layer1
LANG:10027 6 Layer1
6 24
"Border7"
""
1 43 627 E E E 1 E 1 E N "_Window" E N "_Transparent" E E
 E E
24 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  2  0 1  "pictures/background_sqlData.png" 4294967295 E 11 39 101 509
2 2
"Text6"
""
1 1334 890 E E E 1 E 1 E N "_3DText" E N "_Transparent" E E
 E E
3 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 122 472 222 487
0 2 2 "0s" 0 0 0 192 0 0  122 472 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 16 Number of lines:
LANG:10004 13 条目数量:
LANG:10000 18 Ermittelte Zeilen:
LANG:10027 23 Кол-во строк:
2 18
"result"
""
1 1483 1350 E E E 1 E 1 E N "_3DText" E N "_Transparent" E E
 E E
19 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 234 472 288 488
0 2 2 "6d" 6 0 0 64 0 0  234 472 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 3 xxx
LANG:10004 3 xxx
LANG:10000 3 xxx
LANG:10027 3 xxx
2 19
"Text1"
""
1 340 745 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
20 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 122 487 223 502
0 2 0 "0s" 0 0 0 192 0 0  122 487 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 15 Query time [s]:
LANG:10004 15 查询时间[s]
LANG:10000 17 Abfragedauer [s]:
LANG:10027 30 Длит. запроса [с]:
2 21
"timediff"
""
1 1625 1735 E E E 1 E 1 E N "_3DText" E N "_Transparent" E E
 E E
22 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 234 487 288 503
0 2 2 "6.3f" 10 0 0 64 0 0  234 487 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 3 xxx
LANG:10004 3 xxx
LANG:10000 3 xxx
LANG:10027 3 xxx
2 22
"waitSign"
""
1 1394 1374 E E E 1 E 0 E N {0,102,255} E N "_Transparent" E E
 E E
23 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 403 487 565 502
1 2 2 "0s" 0 0 0 193 0 0  484 487 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 30  Query running - please wait! 
LANG:10004 23  正在查询-请等待
LANG:10000 32  Abfrage läuft - bitte warten! 
LANG:10027 87  Запрос обрабатывается - пожалуйста, подождите! 
6 23
"Border6"
""
1 30 584 E E E 1 E 1 E N "_ButtonShadow" E N "_Transparent" E E
 E E
23 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 10 38 100 508
2 25
"Text2"
""
1 315 260 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
25 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 12 12 62 32
0 2 2 "0s" 0 0 0 192 0 0  12 12 1
4
LANG:10001 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,18,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,18,5,40,0,0,0,0,0
0 4
LANG:10001 4 Data
LANG:10004 4 Data
LANG:10000 5 Daten
LANG:10027 12 Данные
2 26
"timediff2"
""
1 1625 1750 E E E 1 E 1 E N "_3DText" E N "_Transparent" E E
 E E
25 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 234 502 288 518
0 2 2 "6.3f" 10 0 0 64 0 0  234 502 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 3 xxx
LANG:10004 3 xxx
LANG:10000 3 xxx
LANG:10027 3 xxx
2 27
"Text4"
""
1 323 760 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
26 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

4
"sizePolicy" "Fixed Fixed"
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 122 502 225 517
0 2 0 "0s" 0 0 0 192 0 0  122 502 1
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0 4
LANG:10001 15 Total time [s]:
LANG:10004 15 总时间[s]：
LANG:10000 16 Gesamtdauer [s]:
LANG:10027 27 Общее время [с]:
10 28
"Polyline1"
""
1 553 440 E E E 1 E 1 E N "_Window" E N "_Transparent" E E
 E E
27 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 2 1 0 1 E U  0 E 3 553 440
553 469
400 469
 0
10 29
"Polyline2"
""
1 401 468 E E E 1 E 1 E N "_ButtonShadow" E N "_Transparent" E E
 E E
28 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 2 1 0 1 E U  0 E 3 401 468
401 441
551 441
 0
6 30
"busySize"
""
1 405 444 E E E 1 E 1 E N "_3DFace" E N "_Transparent" E E
 E E
29 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  0 E 405 444 547 461
6 31
"busyFlag"
""
1 407 445 E E E 1 E 0 E N {0,0,153} E N {0,0,153} E E
 E E
30 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

3
"layoutAlignment" "AlignCenter"
"dashclr"N "_Transparent"
"antiAliased" "0"
E E 0 1 1 0 1 E U  1 E 407 445 443 464
13 11
"Button6"
""
1 995 1510 E E E 1 E 1 E N "_ButtonText" E N "_Button" E E
 E E
12 0 0 0 0 0
E E E
0
4
LANG:10001 12 Delete table
LANG:10004 12 删除表格
LANG:10000 16 Tabelle löschen
LANG:10027 29 Удалить таблицу

1
"layoutAlignment" "AlignCenter"
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0  713 478 801 506

T 
4
LANG:10001 12 Delete table
LANG:10004 12 删除表格
LANG:10000 15 Tabelle lösch.
LANG:10027 18 Удал.табл.
"main()
{
  setMultiValue( \"resultTable\",    \"deleteAllLines\",
                 \"timediff\", \"text\", \"\",
                 \"result\",   \"text\", \"\" );
}
" 0
 E E E
13 15
"Button4"
""
1 1965 1373 E E E 1 E 1 E N "_ButtonText" E N "_Button" E E
 E E
16 0 0 0 0 0
E E E
0
3
LANG:10000 17 Starten der Query
LANG:10001 17 Execute the query
LANG:10027 31 Выполнить запрос

1
"layoutAlignment" "AlignCenter"
4
LANG:10001 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10004 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10000 26 Arial,-1,13,5,40,0,0,0,0,0
LANG:10027 26 Arial,-1,13,5,40,0,0,0,0,0
0  803 478 891 506

T 
4
LANG:10001 11 Start query
LANG:10004 12 开始查询
LANG:10000 11 Start Query
LANG:10027 18 Запустить
"main()
{
  time            tStart;
  time            tStop;
  float           fDiff,fDiff2;
  int             iErr;
  dyn_dyn_anytype dda;
  dyn_errClass    dcErr;
  int             iErrCode;
  int i_resultTable;

  // Prepare
  this.enabled = false;
  setMultiValue( \"resultTable\",    \"deleteAllLines\",
                 \"timediff\", \"text\", \"\",
                 \"timediff2\",\"text\", \"\",
                 \"result\",   \"text\", \"\" );

  if( strlen( g_sQuery ) <= 0 )
  {
    ChildPanelOnCentralModal( \"vision/MessageWarning\",
                              getCatStr( \"general\", \"warning\" ),
                              makeDynString( getCatStr( \"sql\", \"createSqlFirst\" )));
    this.enabled = true;
    return;
  }

  addGlobal(\"g_busyThread\",INT_VAR);
  g_busyThread = -1;
  std_startBusy();
  resultTable.visible=false;

  waitSign.visible = true;
  tStart = getCurrentTime();
  iErr   = 0;
  iErr   = dpQuery( g_sQuery, dda );

  tStop  = getCurrentTime();
  fDiff  = tStop - tStart;

  // Any errors ?
  dcErr  = getLastError();
  if( dynlen( dcErr ) > 0 )
  {
    iErrCode = getErrorCode( dcErr[1] );
    ChildPanelOnCentralModal( \"vision/MessageWarning\",
                              getCatStr( \"general\", \"warning\" ),
                              makeDynString( getCatStr( \"sql\", \"errorOccured\" )));
    this.enabled = true;
    waitSign.visible = false;
    std_stopBusy();
    resultTable.visible=true;
    return;
  }
  else if( iErr > 0 )
  {
    ChildPanelOnCentralModal( \"vision/MessageWarning\",
                              getCatStr( \"general\", \"warning\" ),
                              makeDynString( getCatStr( \"sql\", \"errorOccured\" )));
    this.enabled = true;
    waitSign.visible = false;
    std_stopBusy();
    resultTable.visible=true;
    return;
  }
  
  // call the function to write data to the table only if the query returned a valid result
  if ( dynlen(dda) > 1 )
    i_resultTable = writeResultToTable(dda);
  else
    i_resultTable = 1;

  tStop  = getCurrentTime();
  fDiff2  = tStop - tStart;

  if( i_resultTable > 0 )
  {
    setMultiValue( \"result\",   \"text\",  dynlen(dda)-1,
                   \"timediff\", \"text\",  fDiff,
                   \"timediff2\",\"text\",  fDiff2 );
  }

  this.enabled = true;
  waitSign.visible = false;
  std_stopBusy();
  resultTable.visible=true;

  // show the first line in the table
  resultTable.lineVisible(0);
}


int writeResultToTable(dyn_dyn_anytype dda_result)
{
  int i, c, i_columns;
  string s_columnName;
  dyn_string ds_columnNames;
  dyn_dyn_anytype dda_tableLines;
  
  // delete all lines in the table
  resultTable.deleteAllLines();
  
  // delete all columns except the DPE and Time column
  i_columns = resultTable.columnCount;
  for(i=i_columns;i>2;i--)
    resultTable.deleteColumn(i-1);
  
  ds_columnNames[1] = \"DPE\";
  ds_columnNames[2] = \"Time\";
  
  // check if a SELECT ALERT query was used
  if ( strpos(g_sQuery,\"SELECT ALERT\",0) > -1 )
  {
    for(i=1;i<=dynlen(dda_result);i++)
    {
      dyn_anytype da_line;
      
      da_line = dda_result[i];
      // add the columns and prepare the table header
      if( i == 1 )
      {
        // set the Time column visible
        resultTable.columnVisibility(1,1);

        for(c=3;c<=dynlen(da_line);c++)
        {
          // the DPE and Time column is already defined in the table
          resultTable.insertColumn(c-1);
          resultTable.columnHeader(c-1,da_line[c]);
          resultTable.columnName(c-1,da_line[c]);
          resultTable.columnWidth(c-1,170);
          ds_columnNames[c] = da_line[c];
        }
      }
      else
      {
        for(c=1;c<=dynlen(da_line);c++)
        {
          // DPE in the first column
          if ( c == 1 )
          {
            dda_tableLines[c][i-1] = (string)da_line[c];
          }
          // Time in the second column
          else if ( c == 2 )
          {
            dda_tableLines[c][i-1] = (time)da_line[c];
          }
          else
          {
            // for float variables the value is formatted
            if ( getTypeName(da_line[c]) == \"float\" )
            {
              string s_value;
              
              sprintf(s_value,\"%20.3f\",da_line[c]);
              dda_tableLines[c][i-1] = s_value;
            }
            else
            {
              dda_tableLines[c][i-1] = (string)da_line[c];
            }
          }
        }
      }
    }
  }
  else
  {
    for(i=1;i<=dynlen(dda_result);i++)
    {
      dyn_anytype da_line;
      
      da_line = dda_result[i];
      // add the columns and prepare the table header
      if(i == 1)
      {
        // set the Time column invisible
        resultTable.columnVisibility(1,0);

        for(c=2;c<=dynlen(da_line);c++)
        {
          // the first column is already defined in the table
          resultTable.insertColumn(c);
          resultTable.columnHeader(c,da_line[c]);
          resultTable.columnName(c,da_line[c]);
          resultTable.columnWidth(c,170);
          ds_columnNames[c+1] = da_line[c];
        }
      }
      else
      {
        for(c=1;c<=dynlen(da_line);c++)
        {
          // DPE in the first column
          // Time column is invisible, we need to saved a dummy value
          if ( c == 1 )
          {
            dda_tableLines[c][i-1] = (string)da_line[c];
            dda_tableLines[c+1][i-1] = \"\";
          }
          else
          {
            // for float variables the value is formatted
            if ( getTypeName(da_line[c]) == \"float\" )
            {
              string s_value;
              
              sprintf(s_value,\"%20.3f\",da_line[c]);
              dda_tableLines[c+1][i-1] = s_value;
            }
            else
            {
              dda_tableLines[c+1][i-1] = (string)da_line[c];
            }
          }
        }
      }
    }
  }
  
  // write the result to the table
  resultTable.appendLines(dynlen(dda_tableLines[1]),ds_columnNames,dda_tableLines);

  return(1);
}


" 0
 E E "main()
{
  setMultiValue( \"resultTable\",    \"deleteAllLines\",
                 \"timediff\", \"text\", \"\",
                 \"timediff2\",\"text\", \"\",
                 \"result\",   \"text\", \"\" );
}
" 0

25 32
"resultTable"
""
1 120 40 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
31 0 0 0 0 0
E E E
0
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

1
"layoutAlignment" "AlignNone"
4
LANG:10001 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10004 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10000 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10027 32 Courier New,-1,13,5,50,0,0,0,0,0
0  118 38 892 472
EE 1 0 1 2 0 "DPE" 36 1 0 "s" 4
LANG:10001 3 DPE
LANG:10004 3 DPE
LANG:10000 3 DPE
LANG:10027 3 DPE
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

300 "Time" 22 0 0 "s" 4
LANG:10001 4 Time
LANG:10004 6 时间
LANG:10000 4 Zeit
LANG:10027 4 Time
E
3
LANG:10000 0 
LANG:10001 0 
LANG:10027 0 

190 
18 18 10 0
4
LANG:10001 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10004 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10000 32 Courier New,-1,13,5,50,0,0,0,0,0
LANG:10027 32 Courier New,-1,13,5,50,0,0,0,0,0
0 0 2 1 1 7
1 0
0
LAYER, 1 
4
LANG:10001 6 Layer2
LANG:10004 6 Layer2
LANG:10000 6 Layer2
LANG:10027 6 Layer2
0
LAYER, 2 
4
LANG:10001 6 Layer3
LANG:10004 6 Layer3
LANG:10000 6 Layer3
LANG:10027 6 Layer3
0
LAYER, 3 
4
LANG:10001 6 Layer4
LANG:10004 6 Layer4
LANG:10000 6 Layer4
LANG:10027 6 Layer4
0
LAYER, 4 
4
LANG:10001 6 Layer5
LANG:10004 6 Layer5
LANG:10000 6 Layer5
LANG:10027 6 Layer5
0
LAYER, 5 
4
LANG:10001 6 Layer6
LANG:10004 6 Layer6
LANG:10000 6 Layer6
LANG:10027 6 Layer6
0
LAYER, 6 
4
LANG:10001 6 Layer7
LANG:10004 6 Layer7
LANG:10000 6 Layer7
LANG:10027 6 Layer7
0
LAYER, 7 
4
LANG:10001 6 Layer8
LANG:10004 6 Layer8
LANG:10000 6 Layer8
LANG:10027 6 Layer8
0
0
